# ๐ง ุฅุตูุงุญ ูุดููุฉ ุตูุญุฉ ุฅุชูุงู ุงูุทูุจ ุนูู ุงููุงุชู

## โ ุงูุชุนุฏููุงุช ุงููุทุจูุฉ

### 1. ุชูููู CDN Cache Time โก
**ุงูููู**: `next.config.production.js`
- **ูุจู**: `s-maxage=60` (60 ุซุงููุฉ)
- **ุจุนุฏ**: `s-maxage=5` (5 ุซูุงูู ููุท)
- **ุงูุณุจุจ**: ุงููุงุชู ูุงู ูุญุตู ุนูู ูุณุฎุฉ ูุฏููุฉ ูู ุงูุตูุญุฉ ูุฎุฒูุฉ ุนูู CDN

### 2. ุฅุถุงูุฉ checkoutRestaurant State
**ุงูููู**: `app/menu/[id]/page.js`
- ุฃุถูู state ุฌุฏูุฏ ูุชุฎุฒูู ุงูุจูุงูุงุช ุงููุญุฏุซุฉ ุฎุตูุตุงู ููู checkout
- ูุฐุง ูุถูู ุฃู ุงูู modal ุชุนุฑุถ ุฃุญุฏุซ ุงูุจูุงูุงุช ุงููุฌููุจุฉ ูู DB

### 3. ุชุญุฏูุซ openCheckout Function
**ุงูููู**: `app/menu/[id]/page.js`
- ุฅุถุงูุฉ console logs ูุชุชุจุน ุนูููุฉ ุงูู refetch ุนูู ุงููุงุชู
- ุชุญุฏูุซ ูู ูู `restaurant` ู `checkoutRestaurant` states
- ุฅุถุงูุฉ ุชุฃุฎูุฑ 100ms ูุถูุงู ุฅุนุงุฏุฉ ุชุตููุฑ ุงูู React ุจุดูู ูุงูู

### 4. ุงุณุชุฎุฏุงู checkoutRestaurant ูู ุงูููุฏุงู
**ุงูููู**: `app/menu/[id]/page.js` - ุฌููุน ูุฑุงุฌุน ุทุฑู ุงูุฏูุน/ุงูุชูุตูู
- ุบููุฑูุง ูู `restaurant.accepts_dine_in` ุฅูู `checkoutRestaurant?.accepts_dine_in`
- ุบููุฑูุง ูู `restaurant.accepts_delivery` ุฅูู `checkoutRestaurant?.accepts_delivery`
- ุบููุฑูุง ูู `restaurant.accepts_cash` ุฅูู `checkoutRestaurant?.accepts_cash`
- ุบููุฑูุง ูู `restaurant.accepts_instapay` ุฅูู `checkoutRestaurant?.accepts_instapay`

---

## ๐ ุงูุฎุทูุงุช ุงููุทููุจุฉ ูููุดุฑ

### ุงูุฎุทูุฉ 1: ุงุฎุชุจุงุฑ ูุญูู
```bash
npm run dev
```
- ุงูุชุญ ุงูุตูุญุฉ ุนูู ุณุทุญ ุงูููุชุจ ูุงููุงุชู
- ุนุฏูู ุฅุนุฏุงุฏุงุช ูุทุนู (ูุนูู/ุนุทูู Instapay ุฃู ุทุฑููุฉ ุชูุตูู)
- ุงูุชุญ developer console ุนูู ุงููุงุชู (F12 ุฃู ุนุจุฑ USB debugging)
- ุงุจุญุซ ุนู ุฑุณุงุฆู `๐ข openCheckout` ูู Console

### ุงูุฎุทูุฉ 2: ุงููุดุฑ ุนูู Vercel/ุฎุงุฏูู
```bash
git add .
git commit -m "Fix mobile checkout payment/delivery settings cache issue"
git push
```

### ุงูุฎุทูุฉ 3: ุงุฎุชุจุงุฑ ูู ุงูุฅูุชุงุฌ
1. **ุนูู ุงููุงุชู ุจููุณ ุดุจูุฉ ุงูุฅูุชุงุฌ**:
   - ุงูุชุญ ุงููููุน
   - ุนุฏูู ุฅุนุฏุงุฏุงุช ุงููุทุนู (ูุซูุงู ุนุทูู "Instapay")
   - ุงูุชุญ ุตูุญุฉ ุงููุงุฆูุฉ ุนูู ุงููุงุชู
   - ุงูุชุญ ููุฏุงู Checkout
   
2. **ูุง ูุฌุจ ุฃู ุชุฑุงู**:
   - โ ูุง ูุธูุฑ ุฒุฑ InstaPay (ุฅุฐุง ุนุทููุชู)
   - โ ุชุธูุฑ ููุท ุงูุทุฑู ุงูููุนููุฉ (ุฃู ุงูุทุฑู ุงูุตุญูุญุฉ)
   - โ ูู Console ุชุฑู: `๐ข openCheckout: STARTING refetch for restaurant...`
   - โ ุซู ุชุฑู: `โ openCheckout: Updating checkout restaurant state with fresh data:`

---

## ๐ ุชุญูู ูู ุณุฌูุงุช ุงููุชุตูุญ (ุงุฎุชูุงุฑู)

ุฅุฐุง ูู ุชูุฌุญ ุงูุฅุตูุงุญุงุชุ ุงูุชุญ DevTools ุนูู ุงููุงุชู ูุชุญูู:

### Chrome DevTools ุนูู ุงููุงุชู:
```
chrome://inspect/#devices
```
ุซู ุงุชุตู ุจุฌูุงุฒู ูุฑุงูุจ Console ููุจุญุซ ุนู:
- `๐ข openCheckout: STARTING...` โ ุนูููุฉ ุฌูุจ ุงูุจูุงูุงุช ุจุฏุฃุช
- `Error refetching...` โ ูุดููุฉ ูู ุงูุงุชุตุงู ุจู Supabase
- `โ openCheckout: Setting showCheckout to true` โ ุงูููุฏุงู ุฌุงูุฒุฉ ููุนุฑุถ

---

## ๐๏ธ ุญู ูุดุงูู ุฅุถุงููุฉ (ุฅู ูุฌุฏุช)

### ุฅุฐุง ูู ุชุธูุฑ ุงูุชุบููุฑุงุช ูุงุฒุงู:
1. **ุงูุณุญ cache ุงููุชุตูุญ ุนูู ุงููุงุชู**:
   - Settings โ Apps โ [Browser name] โ Storage โ Clear Cache
   
2. **ุฌุฑูุจ Incognito Mode** ูุชุฌุงูู ุงูู cache ูุญููุงู

3. **ุฅุนุงุฏุฉ ุดุญู ุงูุตูุญุฉ** (Cmd+Shift+R ุนูู Mac ุฃู Ctrl+Shift+R ุนูู Windows/Linux)

4. **ุชุญูู ูู Supabase Connection**:
   - ูู ุงูุฅูุชุฑูุช ุนูู ุงููุงุชู ูุณุชูุฑุ
   - ูู ุงููุชุตูุญ ูููุน ุงูุงุชุตุงูุงุช (VPN/Firewall)?

---

## ๐ ุดุฑุญ ุงููุดููุฉ ุงูุฃุณุงุณูุฉ

**ุงูุณุจุจ ุงูุฌุฐุฑู**:
1. ~~localStorage ูุงู ูุชุฌุงูุฒ ุจูุงูุงุช DB~~
2. CDN ูุฎุฒู ุงููุณุฎุฉ ุงููุฏููุฉ ูู ุงูุตูุญุฉ ูู 60 ุซุงููุฉ
3. ุงููุงุชู ูุญุตู ุนูู ูุณุฎุฉ HTML/JS ูุฏููุฉ ูู ุงูู cache
4. ุนูุฏ ูุชุญ checkoutุ ูุงูุช ุชุณุชุฎุฏู ุจูุงูุงุช ุนุชููุฉ ูู `restaurant` state

**ุงูุญู**:
1. โ ุฃุฒููุง ุชุฃุซูุฑ localStorage ุนูู ุฅุนุฏุงุฏุงุช ุงูุฅุฏุงุฑุฉ
2. โ ููููุง CDN cache ูู 60s ุฅูู 5s
3. โ ุฃุถููุง refetch ูุจุงุดุฑ ุนูุฏ ูุชุญ checkout
4. โ ุงุณุชุฎุฏููุง state ูููุตู (`checkoutRestaurant`) ูุถูุงู ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ

---

## โ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ ุงููุชููุนุฉ

**ูุจู ุงูุฅุตูุงุญ**:
- โ ุงูุชุบููุฑุงุช ุชุธูุฑ ุนูู ุณุทุญ ุงูููุชุจ ููุท
- โ ุงููุงุชู ูุญุงูุธ ุนูู ุงูุฅุนุฏุงุฏุงุช ุงููุฏููุฉ ููุชุฑุฉ ุทูููุฉ

**ุจุนุฏ ุงูุฅุตูุงุญ**:
- โ ุงูุชุบููุฑุงุช ุชุธูุฑ ููุฑุงู on ุงููุงุชู ูุงูููุจููุชุฑ
- โ ุนูุฏ ูู ูุชุญ checkoutุ ูุชู ุฌูุจ ุฃุญุฏุซ ุงูุจูุงูุงุช ูู DB
- โ ูุง ุชุฃุซุฑ ุจู localStorage ุฃู CDN cache ูุฏูู

---

**ููุงุญุธุฉ ูููุฉ**: ุจุนุฏ ุงููุดุฑุ ูุฏ ูุณุชุบุฑู ุงูุฃูุฑ ุฏูุงุฆู ููููุฉ ุญุชู ูุชู ุชุญุฏูุซ ุฌููุน ุฃุทุฑุงู CDN. ุฅุฐุง ูู ุชุฑ ุงูุชุบููุฑุงุช ููุฑุงูุ ุงูุชุธุฑ 10 ุฏูุงุฆู ุซู ุฃุนุฏ ุงููุญุงููุฉ.
